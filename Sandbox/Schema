
-- Inspired by:
-- https://developer.apple.com/documentation/cloudkit/integrating_a_text-based_schema_into_your_workflow?changes=la

item := node_trait | link_trait

node_trait := "NODE" "TRAIT" identifier [attributes] [links]
attributes := {attribute}
links := {link}
attribute := identifier type [string]
link := identifier [OUTGOING|INCOMING] [WHERE predicate]


NODE TRAIT Tarot (
)
LINKS (
    --- Cards that belong to the tarot.
    cards OUTGOING WHERE name = 'card',
    
    domain_cards OUTGOING WHERE name = 'card' AND TARGET.type == 'domain',
    indicator_cards OUTGOING WHERE name = 'card' AND TARGET.type == 'domain',
)

NODE TRAIT Card (
    --- Card name.
    name STRING "Name",
    --- Card level number
    level NUMBER "Level",
)
LINKS (
    --- Cards that are amplified by this card.
    amplifies,
    --- Cards that amplify this card.
    amplified_by INCOMING NAME amplifies,
    suffer_missing NAMED "suffer-missing"
)

LINK TRAIT amplifies

NODE TRAIT Note (
    text STRING
)
LINKS (
    comment OUTGOING,
    previus OUTGOING,
    next OUTGOING,
    referenced_by INCOMING see_also
)
